<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>System zamówień zakupów</title>
<style type="text/css">
	*
	{
		margin: 0;
		padding: 0;
		background: rgba(0,0,0,0);
		font-family: Arial, Helvetica, sans-serif;
	}
	body, html
	{
		overflow-x: hidden;
		background: black;
		font-size: 2.5vh;
		color: white;
	}
	input
	{
		position: relative;
		box-sizing: border-box;
		border: solid 0.4vh white;
		background: black;
		color: white;
		box-shadow: inset 0 0 0.8vh 0.4vh #939393;
		padding: 0.5vh;
		padding-left: 0.7vh;
		padding-right: 0.7vh;
		margin-top: 1vh;
		margin-bottom: 1vh;
		width: 100%;
		color: white;
		font-size: 2.2vh;
		text-align: center;
	}
	input:focus
	{
		outline: none;
	}
	li
	{
		list-style-type: none;
	}
	.window
	{
		position: fixed;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		max-width: 50vh;
		max-height: 90vh;
		overflow-x: hidden;
		overflow-y: scroll;
		scrollbar-width: none;
		-ms-overflow-style: none;
		border: solid 0.4vh #393939;
		background: #2F2F2F;
		box-shadow: 0 0 1.5vh 1vh black;
	}
	.window.hidden
	{
		display: none;
	}
	.window::-webkit-scrollbar
	{
		display: none;
	}
	.roll
	{
		white-space: nowrap;
		overflow-y: hidden;
		overflow-x: auto;
		scrollbar-width: none;
		-ms-overflow-style: none;
	}
	.roll::-webkit-scrollbar
	{
		display: none;
	}
	.roll *
	{
		display: inline-block;
	}
	.window .content
	{
		position: relative;
		display: flex;
		flex-direction: column;
		flex-wrap: wrap;
		justify-content: center;
		align-items: flex-start;
		align-content: center;
		width: 100%;
		margin-top: 5vh;
	}
	.window .close
	{
		position: absolute;
		top: 0.5vh;
		right: 0.5vh;
		width: 4vh;
		height: 4vh;
		border: none;
		border-radius: 0.7vh;
		align-items: center;
		text-align: center;
		background: #750700;
	}
	.window .close::after
	{
		content: 'X';
		color: #393939;
		font-weight: bold;
		font-size: 3vh;
	}
	main
	{
		position: relative;
		height: 93vh;
		width: 240vh;
		background: rgba(0,0,0,0);
		left: 50%;
		margin-left: -175vh;
		transition: 0.7s;
	}
	section.screen
	{
		position: relative;
		box-sizing: border-box;
		margin-left: 6vh;
		margin-right: 6vh;
		float: left;
		width: 48vh;
		height: 90vh;
		top: 1vh;
		background: #1B1B1B;
		border: solid 0.4vh #252525;
		overflow-y: scroll;
		overflow-x: hidden;
		scrollbar-width: none;
		-ms-overflow-style: none;
	}
	section.screen::-webkit-scrollbar
	{
		display: none;
	}
	section.screen h1
	{
		position: relative;
		width: 80%;
		margin-left: 10%;
		padding: 0.7vh;
		color: white;
		text-align: center;
		letter-spacing: 0.05vh;
		border-bottom: solid 0.5vh white;
		font-size: 3vh;
	}
	footer
	{
		position: fixed;
		left: 0;
		bottom: 0;
		height: 7vh;
		width: 24vh;
		background: rgba(207,207,207,0.2);
		border: solid 0.4vh rgba(207,207,207,0.4);
		border-bottom: none;
		border-left: none;
		border-top-right-radius: 3.5vh;
	}
	footer button
	{
		position: relative;
		box-sizing: border-box;
		margin: 0.5vh;
		float: left;
		width: 5vh;
		height: 5vh;
		border-radius: 50%;
		top: 1vh;
		background: black;
		border: solid 0.4vh #252525;
		transition: 0.2s;
	}
	footer button.marked
	{
		top: 0;
	}
	#searchBox li
	{
		position: relative;
		align-content: center;
		width: 92%;
		margin-top: 0.5vh;
		margin-bottom: 0.5vh;
		min-height: 4vh;
		background: #393939;
	}
	#searchBox li span
	{
		display: block;
		padding: 0.5vh;
		padding-left: 1vh;
		padding-right: 1vh;
		color: white;
		font-size: 1.7vh;
	}
	#searchBox li span.description
	{
		color: #7F7F7F;
		font-size: 1.4vh;
	}
	#orderStatistics
	{
		position: relative;
		width: 100%;
		height: 7vh;
		margin-top: 1.5vh;
		margin-bottom: 1.5vh;
		background: #252525;
	}
	#shopsButtonBox
	{
		box-sizing: border-box;
		width: 100%;
		height: 5vh;
		padding: 0.5vh;
		padding-left: 2vh;
		padding-right: 2vh;
		background: #252525;
		margin-bottom: 1vh;
		white-space: nowrap;
	}
	#shopsButtonBox button
	{
		margin: 0;
		margin-left: 0.7vh;
		margin-right: 0.7vh;
		width: 4vh;
		height: 4vh;
		padding: 0;
		border: 0;
		border-radius: 1vh;
	}
	#wardrobesButtonBox
	{
		box-sizing: border-box;
		width: 100%;
		height: 6vh;
		padding: 0.5vh;
		padding-left: 2vh;
		padding-right: 2vh;
		background: #252525;
		margin-bottom: 1vh;
		white-space: nowrap;
	}
	#wardrobesButtonBox button
	{
		margin: 0;
		margin-left: 0.7vh;
		margin-right: 0.7vh;
		width: 5vh;
		height: 5vh;
		padding: 0;
		border: 0;
		border-top-right-radius: 0.5vh;
		border-top-left-radius: 0.5vh;
	}
	#wardrobesBox
	{
		box-sizing: border-box;
		width: 100%;
		height: 58vh;
		padding-left: 2vh;
		padding-right: 2vh;
	}
	#wardrobe
	{
		display: grid;
		grid-template-columns: repeat(3, 30vh);
		grid-template-rows: repeat(5, 11.4vh);
		width: 90vh;
		height: 57vh;
		background: black;
		border-top-right-radius: 1vh;
		border-top-left-radius: 1vh;
	}
	#wardrobe div.shelf
	{
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		align-content: center;
	}
	#wardrobe .product
	{
		position: relative;
		width: 28vh;
		height: 7vh;
		background: #4D4D4D;
	}
	#wardrobe .product svg
	{
		position: absolute;
		width: 100%;
		height: 100%;
		box-shadow: inset 0 1vh 3vh -1.5vh white;
	}
	#wardrobe .description
	{
		display: flex;
		flex-direction: row;
		flex-wrap: nowrap;
		justify-content: space-around;
		align-items: center;
		align-content: center;
		width: 28vh;
		height: 3vh;
		background: #393939;
	}
	#wardrobe .productName
	{
		position: absolute;
		display: inline-block;
		word-wrap: break-word;
		white-space: normal;
		width: 100%;
		top: 0.4vh;
		font-size: 1.8vh;
		color: black;
		text-align: center;
	}
</style>
<script>
	const system =
	{
		load: function()
		{
			system.screen.load()
			system.screen.get(0,5)
			system.search.product.load()
			system.windows.searchBox = new AppWindow('searchBox',45,75,'close')
			system.refresh.shopsButtonBox()
			system.refresh.wardrobesButtonBox()
		},
		screen:
		{
			width: 60,
			window: 0,
			buttons: [],
			load: function()
			{
				system.screen.window = document.getElementsByTagName('main')[0]
				const footer = document.getElementsByTagName('footer')[0]
				const screens = Array.from(document.querySelectorAll('section.screen'))
				system.screen.window.style.width = `${screens.length * system.screen.width}vh`
				for (let i=0 ; i<screens.length ; i++)
				{
					const screen = screens[i]
					const color = Number(screen.dataset.theme)
					screen.style.borderColor = `hsl(${color},100%,70%)`
					screen.style.boxShadow = `0 0 1.5vh 0.3vh hsl(${color},100%,50%)`
					const h1 = (screen.getElementsByTagName('h1')||[])[0]
					if (h1)
					{
						h1.style.borderColor = `hsl(${color},100%,70%)`
						h1.style.boxShadow = `0 2.2vh 2vh -2vh hsl(${color},100%,50%)`
						h1.style.color = `hsl(${color},100%,90%)`
						h1.style.textShadow = `0 0 1vh hsl(${color},100%,50%)`
					}
					if (Number(screen.dataset.accessible))
					{
						const button = document.createElement('button')
						button.style.borderColor = `hsl(${color},100%,50%)`
						button.style.boxShadow = `0 0 1vh 0.2vh hsl(${color},100%,30%)`
						button.dataset.screenNr = i+1
						button.onclick = system.screen.get
						footer.appendChild(button)
						system.screen.buttons.push(button)
					}
				}
				footer.style.width = `${6*(system.screen.buttons.length)}vh`
			},
			get: function(event,screenNr)
			{
				screenNr = Number(screenNr)
				if (!screenNr)
				{
					screenNr = Number(event.target.dataset.screenNr)
				}
				if (screenNr>0)
				{
					system.screen.window.style.marginLeft = `-${((screenNr-1)*system.screen.width)+(system.screen.width/2)}vh`
					for (const button of system.screen.buttons)
					{
						if (!button)
						{
							continue
						}
						else if (Number(button.dataset.screenNr) === screenNr)
						{
							button.classList.add('marked')
						}
						else
						{
							button.classList.remove('marked')
						}
					}
				}
				else
				{
					console.error('problem z numerem ekranu')
				}
			},
		},
		search:
		{
			product:
			{
				input: 0,
				result: 0,
				load: function()
				{
					system.search.product.input = document.getElementsByName('search')[0]
					system.search.product.result = document.getElementById('searchProduct')
					system.search.product.input.addEventListener('input', system.search.product.action);
				},
				action: function()
				{
					events.search = Date.now()
					setTimeout(system.search.product.get,1000)
				},
				get: function()
				{
					if (!(Date.now() - events.search > 998)){return}
					const products = [1,2,3,4]
					system.search.product.show(products)
				},
				show: function(list)
				{
					system.windows.searchBox.clear()
					for (let index of list)
					{
						const product = data.products[index]
						const li = document.createElement('li')
						li.onclick = ()=>{system.windows.searchBox.close()}
						//li.style.background = `hsl(${product.color},100%,15%)`
						if (true)
						{
							const span = document.createElement('span')
							span.innerHTML = system.create.productText(product)
							li.appendChild(span)
						}
						if (true)
						{
							const span = document.createElement('span')
							span.className = 'description'
							span.innerHTML = `${system.create.price(product.price)} &nbsp; (${system.create.priceContent(product)})`
							li.appendChild(span)
						}
						const shop = (product.position||[])[0]||0
						const wardrobe = (product.position||[])[1]||0
						if (shop && wardrobe)
						{
							const span = document.createElement('span')
							span.className = 'description'
							span.innerHTML = `${data.shops[shop].name} > ${data.shops[shop].wardrobes[wardrobe].name}`
							li.appendChild(span)
							li.onclick = ()=>{get.wardrobes(shop,wardrobe);system.windows.searchBox.close()}
						}
						system.windows.searchBox.add(li)
					}
					system.windows.searchBox.open()
				}
			}
		},
		create:
		{
			price: function(value)
			{
				let string = Math.floor(value)
				string += ','
				string += ('0'+Math.round((value*100)%100)).slice(-2)
				return string + ' zł'
			},
			priceContent: function(product)
			{
				if (product.unit)
				{
					return `${system.create.price(product.price)} / ${product.unitValue}${['szt','kg','g','l','ml'][product.unit]}.`
				}
				else
				{
					if (product.unitValue > 1)
					{
						return `${system.create.price((product.price / product.content) * product.unitValue)} / ${product.unitValue}${['szt','kg','g','l','ml'][product.contentUnit]}.`
					}
					return `${system.create.price((product.price / product.content) * product.unitValue)} / ${['szt','kg','g','l','ml'][product.contentUnit]}.`
				}
			},
			productText: function(product)
			{
				let string = `<b>${product.name}</b>`
				string += ` &nbsp; `
				string += `${product.content||product.unitValue||'X'}${['szt','kg','g','l','ml'][product.unit||product.contentUnit]}`
				return string
			}
		},
		refresh:
		{
			shopsButtonBox: function()
			{
				const content = document.getElementById('shopsButtonBox')
				content.innerHTML = ''
				if (true)
				{
					for (let i=1 ; i<data.shops.length ; i++)
					{
						const button = document.createElement('button')
						button.onclick = function()
						{
							setings.selectShop = i
							system.refresh.wardrobesButtonBox()
						}
						button.style.background = data.shops[i].color
						content.appendChild(button)
					}
				}
			},
			wardrobesButtonBox: function()
			{
				const content = document.getElementById('wardrobesButtonBox')
				content.innerHTML = ''
				if (setings.selectShop > 0)
				{
					for (let i=1 ; i<data.shops[setings.selectShop].wardrobes.length ; i++)
					{
						const button = document.createElement('button')
						button.onclick = function()
						{
							setings.selectWardrobe[setings.selectShop] = i
							system.refresh.wardrobe()
						}
						button.style.background = `hsl(${data.shops[setings.selectShop].wardrobes[i].color},100%,20%)`
						content.appendChild(button)
					}
				}
			},
			wardrobe: function()
			{
				const content = document.getElementById('wardrobe')
				content.innerHTML = ''
				if (setings.selectShop)
				{
					const wardrobe = data.shops[setings.selectShop].wardrobes[setings.selectWardrobe[setings.selectShop]]
					for (let i=1 ; i<16 ; i++)
					{
						const product = data.products[wardrobe.shelves[i]||0]
						const shelf = document.createElement('div')
						shelf.className = 'shelf'
						const productBox = document.createElement('div')
						productBox.className = 'product'
						if (product)
						{
							productBox.innerHTML = `<svg fill="hsl(${product.color},100%,50%)" style="background: hsl(${product.color},100%,80%);" viewBox="0 0 96 24" xmlns="http://www.w3.org/2000/svg"><g transform="translate(0,0)"><pathd="M14.77,9.35A2.52,2.52,0,0,1,14,7.59V3a1,1,0,0,0-1-1H11a1,1,0,0,0-1,1V7.59a2.52,2.52,0,0,1-.77,1.76A4.41,4.41,0,0,0,8,12.41V20a2,2,0,0,0,2,2h4a2,2,0,0,0,2-2V12.41A4.41,4.41,0,0,0,14.77,9.35Z" /></g><g transform="translate(24,0)"><path d="M14.77,9.35A2.52,2.52,0,0,1,14,7.59V3a1,1,0,0,0-1-1H11a1,1,0,0,0-1,1V7.59a2.52,2.52,0,0,1-.77,1.76A4.41,4.41,0,0,0,8,12.41V20a2,2,0,0,0,2,2h4a2,2,0,0,0,2-2V12.41A4.41,4.41,0,0,0,14.77,9.35Z" /></g><g transform="translate(48,0)"><path d="M14.77,9.35A2.52,2.52,0,0,1,14,7.59V3a1,1,0,0,0-1-1H11a1,1,0,0,0-1,1V7.59a2.52,2.52,0,0,1-.77,1.76A4.41,4.41,0,0,0,8,12.41V20a2,2,0,0,0,2,2h4a2,2,0,0,0,2-2V12.41A4.41,4.41,0,0,0,14.77,9.35Z" /></g><g transform="translate(72,0)"><path d="M14.77,9.35A2.52,2.52,0,0,1,14,7.59V3a1,1,0,0,0-1-1H11a1,1,0,0,0-1,1V7.59a2.52,2.52,0,0,1-.77,1.76A4.41,4.41,0,0,0,8,12.41V20a2,2,0,0,0,2,2h4a2,2,0,0,0,2-2V12.41A4.41,4.41,0,0,0,14.77,9.35Z" /></g></svg>`
						}
						const productName = document.createElement('span')
						productName.className = 'productName'
						if (product)
						{
							productName.innerHTML = system.create.productText(product)
						}
						productBox.appendChild(productName)
						shelf.appendChild(productBox)
						const descriptionBox = document.createElement('div')
						descriptionBox.className = 'description'
						shelf.appendChild(descriptionBox)
						content.appendChild(shelf)
					}
					content.style.background = `hsl(${wardrobe.color},100%,20%)`
				}
			}
		},
		windows:{},
	}
	const get =
	{
		wardrobes: function(shop,wardrobe)
		{
			//
		},
	}
	const events =
	{
		search: 0,
	}
	const setings =
	{
		selectShop: 0,
		selectWardrobe: [0,0],
	}
	class AppWindow
	{
		constructor(html_id,width,height,close)
		{
			this.window = document.getElementById(html_id)
			this.content = document.createElement('ul')
			this.content.className = 'content'
			this.window.appendChild(this.content)
			if (close)
			{
				const closeButton = document.createElement('button')
				closeButton.className = 'close'
				closeButton.onclick = ()=>{this.close()}
				this.window.appendChild(closeButton)
			}
			this.window.style.width = `${width}vh`
			this.window.style.height = `${height}vh`
			this.window.className = 'window hidden'
		}
		clear()
		{
			this.content.innerHTML = ""
		}
		add(element)
		{
			this.content.appendChild(element)
		}
		open()
		{
			this.window.classList.remove('hidden')
		}
		close()
		{
			this.window.classList.add('hidden')
		}
	}
	const data =
	{
		shops:
		[
			{
				name: 'Brak',
				color: 'black',
				wardrobes:
				[
					{
						name: 'Brak',
						color: 0,
						shelves: [0,0,0,0,0,0,0,0]
					},
				],
			},
			{
				name: 'Dino',
				color: '#39b100',
				wardrobes:
				[
					{
						name: 'Brak',
						color: 0,
						shelves: [0,0,0,0,0,0,0,0]
					},
					{
						name: 'Pieczywo',
						color: 50,
						shelves: [0,1,2,3,0,0,0,0]
					},
				],
			},
		],
		products:
		[
			0,
			{
				name: 'Chleb',
				color: 50,
				symbol: 2,
				price: 5.2,
				unitValue: 100,
				unit: 0,
				baskedFill: 4,
				content: 200,
				contentUnit: 2,
				tags: ['pieczywo'],
				notes: ['testowa notatka'],
				opinions: [{autor:'0303',text:'testowa opinia'}],
				purchaseValue: 0,
				position: [1,1,1],
			},
			{
				name: 'Ciastka',
				color: 70,
				symbol: 3,
				price: 2.99,
				unitValue: 100,
				unit: 0,
				baskedFill: 4,
				content: 500,
				contentUnit: 2,
				tags: ['pieczywo'],
				notes: ['testowa notatka'],
				opinions: [{autor:'0202',text:'testowa opinia'}],
				purchaseValue: 0,
				position: [1,1,2],
			},
			{
				name: 'Kartofle',
				color: 120,
				symbol: 4,
				price: 5,
				unitValue: 1,
				unit: 1,
				baskedFill: 4,
				content: 1,
				contentUnit: 0,
				tags: ['pieczywo'],
				notes: ['testowa notatka'],
				opinions: [{autor:'0202',text:'testowa opinia'}],
				purchaseValue: 0,
				position: [1,1,3],
			},
			{
				name: 'gruszki',
				color: 20,
				symbol: 5,
				price: 5,
				unitValue: 1,
				unit: 0,
				baskedFill: 4,
				content: 1,
				contentUnit: 0,
				tags: ['pieczywo'],
				notes: ['testowa notatka'],
				opinions: [{autor:'0202',text:'testowa opinia'}],
				purchaseValue: 0,
				position: 0,
			},
		]
	}
</script>
</head>
<body onload="system.load()">
	<main>
		<section class="screen" data-theme="87" data-accessible="0">
			<h1>Edytowanie Produktu</h1>
		</section>
		<section class="screen" data-theme="198" data-accessible="0">
			<h1>Edytowanie Klienta</h1>
		</section>
		<section class="screen" data-theme="87" data-accessible="1">
			<h1>Produkty</h1>
		</section>
		<section class="screen" data-theme="198" data-accessible="1">
			<h1>Klienci</h1>
		</section>
		<section class="screen" data-theme="271" data-accessible="1">
			<h1>Zamówienia</h1>
		</section>
		<section class="screen" data-theme="55" data-accessible="1">
			<h1>
				<input type="text" name="search" maxlength="20" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
			</h1>
			<div id="orderStatistics"></div>
			<div id="shopsButtonBox" class="roll"></div>
			<div id="wardrobesButtonBox" class="roll"></div>
			<div id="wardrobesBox" class="roll">
				<div id="wardrobe" class="roll"></div>
			</div>
		</section>
	</main>
	<div id="searchBox"></div>
	<footer></footer>
</body>
</html>
